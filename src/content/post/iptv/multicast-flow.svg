<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" class="fill-arrow" />
    </marker>
  </defs>
  <style>
    .text-title { fill: #333; }
    .text-main { fill: #333; }
    .text-sub { fill: #555; }
    .stroke-sep { stroke: #ccc; }
    .fill-arrow { fill: #666; }

    .fill-green-bg { fill: #e8f5e9; }
    .fill-orange-bg { fill: #fff3e0; }
    .fill-blue-bg { fill: #eceff1; }
    .fill-gray-bg { fill: #f5f5f5; }
    .fill-white-bg { fill: #fff; }

    .text-green { fill: #4caf50; }
    .stroke-green { stroke: #4caf50; }
    
    .text-blue { fill: #1976d2; }
    .stroke-blue { stroke: #1976d2; }

    .stroke-orange { stroke: #ff9800; }
    .stroke-gray { stroke: #607d8b; }
    .stroke-dark { stroke: #333; }

    @media (prefers-color-scheme: dark) {
      .text-title { fill: #eee; }
      .text-main { fill: #eee; }
      .text-sub { fill: #bbb; }
      .stroke-sep { stroke: #555; }
      .fill-arrow { fill: #aaa; }

      .fill-green-bg { fill: #1b5e20; }
      .fill-orange-bg { fill: #e65100; }
      .fill-blue-bg { fill: #263238; }
      .fill-gray-bg { fill: #424242; }
      .fill-white-bg { fill: #616161; }
      
      .text-green { fill: #a5d6a7; }
      .stroke-green { stroke: #a5d6a7; }

      .text-blue { fill: #90caf9; }
      .stroke-blue { stroke: #90caf9; }
      
      .stroke-orange { stroke: #ffcc80; }
      .stroke-gray { stroke: #b0bec5; }
      .stroke-dark { stroke: #ccc; }
    }
  </style>

  <text x="400" y="30" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" class="text-title">Multicast (组播) vs Unicast (udpxy 单播) 流量流向</text>

  <!-- Section 1: Traditional Multicast -->
  <g transform="translate(0, 50)">
    <text x="150" y="30" font-family="Arial, sans-serif" font-size="16" font-weight="bold" class="text-main">传统 IPTV 模式 (组播)</text>
    
    <rect x="50" y="60" width="80" height="60" rx="5" class="fill-green-bg stroke-green" stroke-width="2"/>
    <text x="90" y="95" text-anchor="middle" font-size="12" class="text-main">ISP Source</text>
    <text x="90" y="110" text-anchor="middle" font-size="10" class="text-main">239.x.x.x</text>

    <line x1="130" y1="90" x2="250" y2="90" class="stroke-green" stroke-width="4" marker-end="url(#arrowhead)"/>
    <text x="190" y="80" text-anchor="middle" font-size="12" class="text-green">UDP Stream</text>

    <!-- STB -->
    <rect x="250" y="60" width="80" height="60" rx="5" class="fill-orange-bg stroke-orange" stroke-width="2"/>
    <text x="290" y="95" text-anchor="middle" font-size="12" class="text-main">机顶盒 (STB)</text>
    
    <text x="290" y="140" text-anchor="middle" font-size="12" class="text-sub" font-style="italic">必须物理连接 ITV 口</text>
  </g>

  <line x1="10" y1="200" x2="790" y2="200" class="stroke-sep" stroke-dasharray="4,4"/>

  <!-- Section 2: udpxy Relay -->
  <g transform="translate(0, 220)">
    <text x="150" y="30" font-family="Arial, sans-serif" font-size="16" font-weight="bold" class="text-main">udpxy 模式 (组播转单播)</text>

    <!-- Source -->
    <rect x="50" y="80" width="80" height="60" rx="5" class="fill-green-bg stroke-green" stroke-width="2"/>
    <text x="90" y="115" text-anchor="middle" font-size="12" class="text-main">ISP Group</text>
    <text x="90" y="130" text-anchor="middle" font-size="10" class="text-main">239.1.1.1:5000</text>

    <!-- Multicast Join -->
    <path d="M130,110 L190,110" class="stroke-green" stroke-width="4" marker-end="url(#arrowhead)"/>
    
    <!-- Router with udpxy -->
    <rect x="250" y="60" width="120" height="100" rx="5" class="fill-blue-bg stroke-gray" stroke-width="2"/>
    <text x="310" y="85" text-anchor="middle" font-weight="bold" font-size="14" class="text-main">Router</text>
    <rect x="260" y="95" width="100" height="50" rx="3" class="fill-white-bg stroke-dark"/>
    <text x="310" y="115" text-anchor="middle" font-size="12" font-weight="bold" class="text-main">udpxy</text>
    <text x="310" y="135" text-anchor="middle" font-size="10" class="text-sub">IGMP Join -> UDP Recv</text>

    <!-- HTTP Streams -->
    <path d="M370,110 L480,80" class="stroke-blue" stroke-width="2" marker-end="url(#arrowhead)"/>
    <path d="M370,110 L480,110" class="stroke-blue" stroke-width="2" marker-end="url(#arrowhead)"/>
    <path d="M370,110 L480,140" class="stroke-blue" stroke-width="2" marker-end="url(#arrowhead)"/>

    <text x="420" y="70" text-anchor="middle" font-size="10" class="text-blue">HTTP (TCP)</text>

    <!-- Devices -->
    <rect x="480" y="60" width="60" height="30" rx="3" class="fill-gray-bg stroke-dark"/>
    <text x="510" y="80" text-anchor="middle" font-size="10" class="text-main">Phone</text>

    <rect x="480" y="95" width="60" height="30" rx="3" class="fill-gray-bg stroke-dark"/>
    <text x="510" y="115" text-anchor="middle" font-size="10" class="text-main">PC</text>

    <rect x="480" y="130" width="60" height="30" rx="3" class="fill-gray-bg stroke-dark"/>
    <text x="510" y="150" text-anchor="middle" font-size="10" class="text-main">AppleTV</text>
  </g>
</svg>
